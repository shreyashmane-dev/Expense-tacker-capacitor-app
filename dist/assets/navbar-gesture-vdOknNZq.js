const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/navbar-DKKOqqgn.js","assets/firebase-CCPgoP9_.js","assets/history-B3pBptCI.js","assets/analysis-BgVgcgY5.js"])))=>i.map(i=>d[i]);
import{a as y}from"./firebase-CCPgoP9_.js";import{onAuthStateChanged as b}from"https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";import{Chart as f,registerables as L}from"https://cdn.jsdelivr.net/npm/chart.js@4.4.1/+esm";console.log("Auth Guard: Initializing...");b(y,e=>{const r=window.location.pathname.includes("/auth/"),i=sessionStorage.getItem("guest_mode")==="true";e||i?(console.log("âœ… Auth Guard: User authorized (User or Guest)"),r&&window.location.replace("/dashboard/home.html")):(console.warn("â›” Auth Guard: No user found."),r||window.location.replace("/auth/login.html"))});const S="modulepreload",x=function(e){return"/"+e},g={},l=function(t,r,i){let c=Promise.resolve();if(r&&r.length>0){let a=function(s){return Promise.all(s.map(m=>Promise.resolve(m).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=n?.nonce||n?.getAttribute("nonce");c=a(r.map(s=>{if(s=x(s),s in g)return;g[s]=!0;const m=s.endsWith(".css"),h=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${h}`))return;const d=document.createElement("link");if(d.rel=m?"stylesheet":S,m||(d.as="script"),d.crossOrigin="",d.href=s,o&&d.setAttribute("nonce",o),document.head.appendChild(d),m)return new Promise((C,I)=>{d.addEventListener("load",C),d.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${s}`)))})}))}function u(n){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n}return c.then(n=>{for(const o of n||[])o.status==="rejected"&&u(o.reason);return t().catch(u)})},E="expense_transactions";function p(){return JSON.parse(localStorage.getItem(E))||[]}function N(e){localStorage.setItem(E,JSON.stringify(e))}function O(e){const t=p();t.unshift(e),N(t)}f.register(...L);function A(){const e=p().filter(n=>n.type==="expense"),t={};e.forEach(n=>{const o=Number(n.amount)||0;t[n.category]=(t[n.category]||0)+o});const r=document.getElementById("categoryChart");r&&(window.categoryChart&&window.categoryChart.destroy(),window.categoryChart=new f(r.getContext("2d"),{type:"pie",data:{labels:Object.keys(t),datasets:[{data:Object.values(t),backgroundColor:["#60a5fa","#93c5fd","#bfdbfe","#38bdf8","#7dd3fc","#34d399","#fb7185"]}]},options:{responsive:!0,maintainAspectRatio:!1}}));const i={};e.forEach(n=>{const o=new Date(n.date),a=isNaN(o)?n.date:o.toLocaleString("default",{month:"short",year:"numeric"});i[a]=(i[a]||0)+(Number(n.amount)||0)});const c=document.getElementById("trendChart");c&&(window.trendChart&&window.trendChart.destroy(),window.trendChart=new f(c.getContext("2d"),{type:"line",data:{labels:Object.keys(i),datasets:[{label:"Monthly Expense",data:Object.values(i),borderColor:"#2563eb",fill:!0,backgroundColor:"rgba(37,99,235,0.15)"}]},options:{responsive:!0,maintainAspectRatio:!1}}));const u=document.getElementById("insights");if(u){const n=Object.entries(t).sort((a,s)=>s[1]-a[1])[0],o=e.reduce((a,s)=>a+(Number(s.amount)||0),0);u.innerHTML=`
      <h3>Insights</h3>
      <p>ğŸ’¸ Highest spending category: <b>${n?.[0]||"N/A"}</b></p>
      <p>ğŸ“Š Total expenses: â‚¹${o}</p>
    `}}const B=Object.freeze(Object.defineProperty({__proto__:null,renderCharts:A},Symbol.toStringTag,{value:"Module"}));function v(e){e=(e||"").toLowerCase();const t=p()||[];if(e.includes("balance")){let n=0,o=0;return t.forEach(a=>{a.type==="income"?n+=Number(a.amount)||0:o+=Number(a.amount)||0}),`Your balance is â‚¹${(n-o).toLocaleString()}`}if(e.includes("today")){const n=new Date().toISOString().split("T")[0];return`You spent â‚¹${t.filter(a=>a.date===n&&a.type==="expense").reduce((a,s)=>a+(Number(s.amount)||0),0).toLocaleString()} today`}const r=["food","shopping","travel","upi","entertainment","salary","bills"];for(let n of r)if(e.includes(n))return`You spent â‚¹${t.filter(a=>(a.category||"").toLowerCase()===n&&a.type==="expense").reduce((a,s)=>a+(Number(s.amount)||0),0).toLocaleString()} on ${n}`;const i=e.match(/(\d+[\d,]*)/)?.[1]?.replace(/,/g,"");if(e.includes("add")&&i){const n=Number(i),o={id:Date.now(),amount:n,type:e.includes("income")?"income":"expense",category:"AI",date:new Date().toISOString().split("T")[0],source:"ai"};return O(o),`Added â‚¹${n.toLocaleString()} transaction successfully`}const c=new Date().toISOString().slice(0,7);return t.filter(n=>(n.date||"").startsWith(c)&&n.type==="expense").reduce((n,o)=>n+(Number(o.amount)||0),0)>1e4?"âš ï¸ You are overspending this month. Consider reducing expenses.":"ğŸ¤– I can help with balance, spending, add expense, and insights."}typeof window<"u"&&(window.askAI=v);console.log("App Controller Loaded");function T(){const e=location.pathname.split("/").pop().replace(".html","");document.querySelectorAll(".navbar a").forEach(t=>{t.dataset.page===e&&t.classList.add("active")})}document.addEventListener("DOMContentLoaded",T);document.addEventListener("click",e=>{e.target.tagName==="BUTTON"&&(e.target.style.transform="scale(0.95)",setTimeout(()=>e.target.style.transform="scale(1)",120))});window.Capacitor?.isNativePlatform&&window.Capacitor.isNativePlatform()&&document.addEventListener("click",()=>{try{Capacitor.Plugins.Haptics.impact({style:"light"})}catch{}});b(y,e=>{e&&P()});function P(){k(),D()}function k(){if(document.querySelector(".navbar"))return;const e=document.getElementById("navbar");e&&fetch("/dashboard/navbar.html").then(t=>t.text()).then(t=>{e.innerHTML=t,l(()=>import("./navbar-DKKOqqgn.js"),__vite__mapDeps([0,1])).then(r=>{r.initNavbar&&r.initNavbar()}).catch(r=>{console.error("Failed to load navbar.js:",r)})}).catch(t=>{console.error("Failed to load navbar.html:",t)})}function D(){document.getElementById("income")&&(document.querySelector('script[src$="home.js"]')||l(()=>import("./home-CMtZIXtU.js").then(t=>t.h),[]).catch(t=>console.error("home load failed",t))),(document.getElementById("historyList")||document.getElementById("transactionsUl"))&&(document.querySelector('script[src$="history.js"]')||l(()=>import("./history-B3pBptCI.js"),__vite__mapDeps([2,1])).catch(t=>console.error("history load failed",t))),(document.getElementById("categoryChart")||document.getElementById("trendChart")||document.getElementById("incomeExpenseChart"))&&(document.querySelector('script[src$="analysis.js"]')||l(()=>import("./analysis-BgVgcgY5.js"),__vite__mapDeps([3,1])).catch(t=>console.error("analysis load failed",t)));const e=document.getElementById("aiAskBtn");e&&e.addEventListener("click",()=>{const t=document.getElementById("aiInput"),r=document.getElementById("aiOutput");t.value.trim()&&(r.textContent=v(t.value),t.value="")})}window.addEventListener("transactionAdded",()=>{(document.getElementById("transactionsUl")||document.getElementById("historyList"))&&l(()=>import("./history-B3pBptCI.js"),__vite__mapDeps([2,1])).then(e=>{}).catch(()=>{}),(document.getElementById("categoryChart")||document.getElementById("trendChart"))&&l(()=>Promise.resolve().then(()=>B),void 0).then(e=>{e.renderCharts&&e.renderCharts()}),document.getElementById("income")&&l(()=>import("./home-CMtZIXtU.js").then(e=>e.h),[]).then(()=>{}).catch(()=>{})});window.addEventListener("offline",()=>{const e=document.createElement("div");e.id="connection-status",e.style="position:fixed; bottom:80px; left:50%; transform:translateX(-50%); background:#ef4444; color:white; padding:8px 16px; border-radius:30px; font-size:12px; font-weight:bold; z-index:9999; box-shadow:0 10px 25px rgba(239,68,68,0.4); border:1px solid rgba(255,255,255,0.2); backdrop-filter:blur(10px); animation: slideUp 0.4s ease;",e.innerHTML="<span>âš ï¸ Offline Mode</span>",document.body.appendChild(e)});window.addEventListener("online",()=>{const e=document.getElementById("connection-status");e&&(e.style.background="#10b981",e.style.boxShadow="0 10px 25px rgba(16,185,129,0.4)",e.innerHTML="<span>ğŸŒ Back Online! Syncing...</span>",setTimeout(()=>e.remove(),3e3))});const w=document.createElement("style");w.textContent=`
@keyframes slideUp {
  from { transform: translate(-50%, 50px); opacity: 0; }
  to { transform: translate(-50%, 0); opacity: 1; }
}
`;document.head.appendChild(w);let _=0;document.addEventListener("touchstart",e=>{_=e.touches[0].clientX});document.addEventListener("touchend",e=>{const r=e.changedTouches[0].clientX-_,i=["home.html","history.html","analysis.html","profile.html"],c=i.indexOf(location.pathname.split("/").pop());r<-80&&c<i.length-1&&(location.href=i[c+1]),r>80&&c>0&&(location.href=i[c-1])});export{l as _,O as a,p as g};
